import{S as ae,i as oe,s as ne,e as j,k as F,c as w,a as y,n as I,d as k,b as n,$ as Z,f as J,M as f,a0 as C,a1 as z,a2 as le,a3 as se,a4 as re,G as de,a5 as x,a6 as ie,t as ue,a7 as ce,g as _e,a8 as fe,w as he,x as me,u as pe,a9 as ve,aa as $,r as be,ab as ge,J as ke}from"../../chunks/vendor-dd4ebecb.js";function L(i,{pending:t,error:e,result:a}){let h;async function E(m){const c=h={};m.preventDefault();const v=new FormData(i);t&&t(v,i);try{const r=await fetch(i.action,{method:i.method,headers:{accept:"application/json"},body:v});if(c!==h)return;r.ok?a(r,i):e?e(r,null,i):console.error(await r.text())}catch(r){if(e)e(null,r,i);else throw r}}return i.addEventListener("submit",E),{destroy(){i.removeEventListener("submit",E)}}}function ee(i,t,e){const a=i.slice();return a[6]=t[e],a[7]=t,a[8]=e,a}function te(i,t){let e,a,h,E,m,c,v,r,o,p,_,b,N,M,O,s,d,l,T,R,U,B,V,D,A,G=ke,q,H,K;function Q(...g){return t[3](t[6],t[7],t[8],...g)}function W(){return t[4](t[6],t[7],t[8])}function X(){return t[5](t[6])}return{key:i,first:null,c(){e=j("div"),a=j("form"),h=j("input"),m=F(),c=j("button"),p=F(),_=j("form"),b=j("input"),M=F(),O=j("button"),d=F(),l=j("form"),T=j("button"),V=F(),this.h()},l(g){e=w(g,"DIV",{class:!0});var u=y(e);a=w(u,"FORM",{action:!0,method:!0});var P=y(a);h=w(P,"INPUT",{type:!0,name:!0,class:!0}),m=I(P),c=w(P,"BUTTON",{class:!0,"aria-label":!0}),y(c).forEach(k),P.forEach(k),p=I(u),_=w(u,"FORM",{class:!0,action:!0,method:!0});var S=y(_);b=w(S,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),M=I(S),O=w(S,"BUTTON",{class:!0,"aria-label":!0}),y(O).forEach(k),S.forEach(k),d=I(u),l=w(u,"FORM",{action:!0,method:!0});var Y=y(l);T=w(Y,"BUTTON",{class:!0,"aria-label":!0}),y(T).forEach(k),Y.forEach(k),V=I(u),u.forEach(k),this.h()},h(){n(h,"type","hidden"),n(h,"name","done"),h.value=E=t[6].done?"":"true",n(h,"class","svelte-dmxqmd"),n(c,"class","toggle svelte-dmxqmd"),n(c,"aria-label",v="Mark todo as "+(t[6].done?"not done":"done")),n(a,"action",r="/todos/"+t[6].uid+".json?_method=patch"),n(a,"method","post"),n(b,"aria-label","Edit todo"),n(b,"type","text"),n(b,"name","text"),b.value=N=t[6].text,n(b,"class","svelte-dmxqmd"),n(O,"class","save svelte-dmxqmd"),n(O,"aria-label","Save todo"),n(_,"class","text svelte-dmxqmd"),n(_,"action",s="/todos/"+t[6].uid+".json?_method=patch"),n(_,"method","post"),n(T,"class","delete svelte-dmxqmd"),n(T,"aria-label","Delete todo"),T.disabled=R=t[6].pending_delete,n(l,"action",U="/todos/"+t[6].uid+".json?_method=delete"),n(l,"method","post"),n(e,"class","todo svelte-dmxqmd"),Z(e,"done",t[6].done),this.first=e},m(g,u){J(g,e,u),f(e,a),f(a,h),f(a,m),f(a,c),f(e,p),f(e,_),f(_,b),f(_,M),f(_,O),f(e,d),f(e,l),f(l,T),f(e,V),q=!0,H||(K=[C(o=L.call(null,a,{pending:Q,result:t[1]})),C(L.call(null,_,{result:t[1]})),C(B=L.call(null,l,{pending:W,result:X}))],H=!0)},p(g,u){t=g,(!q||u&1&&E!==(E=t[6].done?"":"true"))&&(h.value=E),(!q||u&1&&v!==(v="Mark todo as "+(t[6].done?"not done":"done")))&&n(c,"aria-label",v),(!q||u&1&&r!==(r="/todos/"+t[6].uid+".json?_method=patch"))&&n(a,"action",r),o&&z(o.update)&&u&1&&o.update.call(null,{pending:Q,result:t[1]}),(!q||u&1&&N!==(N=t[6].text)&&b.value!==N)&&(b.value=N),(!q||u&1&&s!==(s="/todos/"+t[6].uid+".json?_method=patch"))&&n(_,"action",s),(!q||u&1&&R!==(R=t[6].pending_delete))&&(T.disabled=R),(!q||u&1&&U!==(U="/todos/"+t[6].uid+".json?_method=delete"))&&n(l,"action",U),B&&z(B.update)&&u&1&&B.update.call(null,{pending:W,result:X}),u&1&&Z(e,"done",t[6].done)},r(){A=e.getBoundingClientRect()},f(){le(e),G(),se(e,A)},a(){G(),G=re(e,A,ve,{duration:200})},i(g){q||(g&&de(()=>{D||(D=x(e,$,{start:.7},!0)),D.run(1)}),q=!0)},o(g){g&&(D||(D=x(e,$,{start:.7},!1)),D.run(0)),q=!1},d(g){g&&k(e),g&&D&&D.end(),H=!1,ie(K)}}}function Ee(i){let t,e,a,h,E,m,c,v,r,o=[],p=new Map,_,b,N,M=i[0];const O=s=>s[6].uid;for(let s=0;s<M.length;s+=1){let d=ee(i,M,s),l=O(d);p.set(l,o[s]=te(l,d))}return{c(){t=F(),e=j("div"),a=j("h1"),h=ue("Todos"),E=F(),m=j("form"),c=j("input"),r=F();for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){ce('[data-svelte="svelte-181o7gf"]',document.head).forEach(k),t=I(s),e=w(s,"DIV",{class:!0});var l=y(e);a=w(l,"H1",{});var T=y(a);h=_e(T,"Todos"),T.forEach(k),E=I(l),m=w(l,"FORM",{class:!0,action:!0,method:!0});var R=y(m);c=w(R,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),R.forEach(k),r=I(l);for(let U=0;U<o.length;U+=1)o[U].l(l);l.forEach(k),this.h()},h(){document.title="Todos",n(c,"name","text"),n(c,"aria-label","Add todo"),n(c,"placeholder","+ tap to add a todo"),n(c,"class","svelte-dmxqmd"),n(m,"class","new svelte-dmxqmd"),n(m,"action","/todos.json"),n(m,"method","post"),n(e,"class","todos svelte-dmxqmd")},m(s,d){J(s,t,d),J(s,e,d),f(e,a),f(a,h),f(e,E),f(e,m),f(m,c),f(e,r);for(let l=0;l<o.length;l+=1)o[l].m(e,null);_=!0,b||(N=C(v=L.call(null,m,{result:i[2]})),b=!0)},p(s,[d]){if(v&&z(v.update)&&d&1&&v.update.call(null,{result:s[2]}),d&3){M=s[0],be();for(let l=0;l<o.length;l+=1)o[l].r();o=fe(o,d,O,1,s,M,p,e,ge,te,null,ee);for(let l=0;l<o.length;l+=1)o[l].a();he()}},i(s){if(!_){for(let d=0;d<M.length;d+=1)me(o[d]);_=!0}},o(s){for(let d=0;d<o.length;d+=1)pe(o[d]);_=!1},d(s){s&&k(t),s&&k(e);for(let d=0;d<o.length;d+=1)o[d].d();b=!1,N()}}}const Te=async({fetch:i})=>{const t=await i("/todos.json");if(t.ok)return{props:{todos:await t.json()}};const{message:e}=await t.json();return{error:new Error(e)}};function je(i,t,e){let{todos:a}=t;async function h(r){const o=await r.json();e(0,a=a.map(p=>p.uid===o.uid?o:p))}const E=async(r,o)=>{const p=await r.json();e(0,a=[...a,p]),o.reset()},m=(r,o,p,_)=>{e(0,o[p].done=!!_.get("done"),a)},c=(r,o,p)=>e(0,o[p].pending_delete=!0,a),v=r=>{e(0,a=a.filter(o=>o.uid!==r.uid))};return i.$$set=r=>{"todos"in r&&e(0,a=r.todos)},[a,h,E,m,c,v]}class qe extends ae{constructor(t){super();oe(this,t,je,Ee,ne,{todos:0})}}export{qe as default,Te as load};
